<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="portal_my_home_sign" name="Portal My Home : sign request entries" inherit_id="portal.portal_my_home" priority="21">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-if="sign_request" t-call="portal.portal_docs_entry">
                <t t-set="title">Kiosko de Empleado</t>
                <t t-set="url" t-value="'/my/payslips'"/>
                <t t-set="count" t-value="sign_request"/>
            </t>
        </xpath>
    </template>

    <template id="portal_table_striped" name="Portal My Home : sign request entries" inherit_id="portal.portal_table" priority="21">
        <xpath expr="//table" position="attributes">
            <attribute name="class">
                table table-striped rounded mb-0 bg-white o_portal_my_doc_table
            </attribute>
        </xpath>
    </template>

    <template id="doc_sign_logo" inherit_id="sign.doc_sign" priority="21">
        <xpath expr="//header/div/a/img" position="replace">
            <t t-esc="current_request_item.state"/>
                <img t-if="sign_request.create_uid.company_id.logo" t-att-src="image_data_uri(sign_request.create_uid.company_id.logo)" class="float-left" alt="Logo"/>
        </xpath>
        <xpath expr="//header/div/a[last()]/img" position="replace">
                <img t-if="sign_request.create_uid.company_id.logo" t-att-src="image_data_uri(sign_request.create_uid.company_id.logo)" alt="Signed"/>
        </xpath>
    </template>

<!--    <template id="doc_sign_button_cancel" inherit_id="sign._doc_sign">-->
<!--        <xpath expr="//div" position="after">-->
<!--            <div t-if="sign_request.state != 'signed'" class="o_sign_sign_document_button">-->
<!--                <button type="button" class="btn btn-danger">Cancel Document</button>-->
<!--            </div>-->
<!--        </xpath>-->
<!--    </template>-->

    <template id="payroll_sign.payslip_receipt">
        <t t-call = "portal.portal_layout">
<!--            <t t-set="sortby" t-value="state"/>-->
<!--            <t t-set="searchbar_sortings">"{'state': {'label': _('Estado'), 'order': 'state desc'}}"</t>-->
            <t t-set="o_portal_search_panel" t-value="True"/>
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set = "title"> Recibos de NÃ³mina </t>
            </t>
            <div class = "oe_structure" >
                <div class = "container">

                    <t t-call="portal.portal_table">
                        <thead>
                            <tr class="active">
                                <th>Nro</th>
                                <th>Nombre del archivo</th>
                                <th>Documento relacionado</th>
                                <th>Fecha</th>
                                <th>Estado</th>
                                <th>Firmar</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="count" t-value="0"/>
                            <tr t-foreach="sign_request" t-as = "o">
                                <t t-set="count" t-value="count+1"/>
                                <td><t t-esc="count"/></td>
                                <td><t t-esc="o.reference"/></td>
                                <td><t t-esc="o.template_id.attachment_id.res_name"/></td>
                                <td><t t-esc="o.create_date.strftime('%d/%m/%Y')"/></td>
<!--                                <td><t t-esc="dict(o._fields['state']._description_selection(o.env)).get(o.state)"/></td>-->
                                <td t-if="o.state == 'sent'" >Por firmar</td>
                                <td t-if="o.state == 'signed'" >Firmado</td>
                                <td><a t-if="o.state == 'sent'" class="btn btn-sm btn-primary" icon="fa-pencil-square-o" role="button" name="Sign_document" t-att-href="'/sign/document/%d/%s' % (o.id,o.request_item_ids.mapped('access_token')[0])">
                                    <span class="fa fa-pencil-square-o"></span>  Firmar</a>
                                    <a t-if="o.state != 'sent'" class="btn btn-sm btn-light" icon="fa-pencil-square-o" role="button" name="Sign_document" t-att-href="'/sign/document/%d/%s' % (o.id,o.request_item_ids.mapped('access_token')[0])">
                                    <span class="fa fa-eye"></span>  Ver</a></td>

                            </tr>
                        </tbody>
                    </t>
                </div>
            </div>
        </t>
    </template>
</odoo>
