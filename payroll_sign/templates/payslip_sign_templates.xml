<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="payroll_sign.payslip_receipt">
        <t t-call = "portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set = "title"> Recibos de NÃ³mina </t>
            </t>
            <div class = "oe_structure" >
                <div class = "container">

                    <t t-call="portal.portal_table">
                        <thead>
                            <th>Nro</th>
                            <th>Nombre del archivo</th>
                            <th>Empleado</th>
                            <th>Estado</th>
                            <th>Firmar</th>
                        </thead>
                        <tbody>
                            <t t-set="count" t-value="0"/>
                            <tr t-foreach="sign_request" t-as = "o">
                                <t t-set="count" t-value="count+1"/>
                                <td><t t-esc="count"/></td>
                                <td><t t-esc="o.reference"/></td>
                                <td><t t-esc="o.request_item_ids.mapped('partner_id').name"/></td>
                                <td><t t-esc="dict(o._fields['state']._description_selection(o.env)).get(o.state)"/></td>
                                <td><a t-if="o.state == 'sent'" class="btn btn-sm btn-primary" icon="fa-pencil-square-o" role="button" name="Sign_document" t-att-href="'/sign/document/%d/%s' % (o.id,o.request_item_ids.mapped('access_token')[0])">
                                    <span class="fa fa-pencil"></span>  Firmar</a>
                                    <a t-if="o.state != 'sent'" class="btn btn-sm btn-light" icon="fa-pencil-square-o" role="button" name="Sign_document" t-att-href="'/sign/document/%d/%s' % (o.id,o.request_item_ids.mapped('access_token')[0])">
                                    <span class="fa fa-eye"></span>  Ver</a></td>

                            </tr>
                        </tbody>
                    </t>
                </div>
            </div>
        </t>
    </template>
</odoo>
